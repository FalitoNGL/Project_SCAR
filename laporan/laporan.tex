\documentclass[12pt]{article}

% ============================================================
% PACKAGES
% ============================================================
\usepackage[indonesian]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{times}
\usepackage[paperwidth=215mm,paperheight=330mm,left=4cm,right=3cm,top=3cm,bottom=3cm]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{setspace}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{caption}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{indentfirst}
\usetikzlibrary{shapes.geometric, arrows, positioning, fit}
\usepackage{hyperref}

% ============================================================
% KONFIGURASI
% ============================================================
\setstretch{1.5}
\setlength{\parindent}{1.25cm}
\setlength{\parskip}{0pt}
\renewcommand{\arraystretch}{1.1}

% Reduce float spacing for compact layout
\setlength{\textfloatsep}{10pt}
\setlength{\floatsep}{10pt}
\setlength{\intextsep}{10pt}

% Caption format: "Gambar 1. Judul" (titik, bukan titik dua)
\captionsetup{
    font=small,
    labelfont=bf,
    labelsep=period
}

% Prevent widow/orphan lines
\widowpenalty=10000
\clubpenalty=10000
\raggedbottom

\renewcommand{\thesection}{BAB \Roman{section}}
\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}

\titleformat{\section}[block]
  {\normalfont\Large\bfseries\centering}
  {\thesection\\}{0pt}
  {\MakeUppercase}
\titlespacing*{\section}{0pt}{0pt}{1em}

\titleformat{\subsection}[block]
  {\normalfont\normalsize\bfseries}
  {\thesubsection}{1em}{}
\titlespacing*{\subsection}{0pt}{1em}{0.5em}

\titleformat{\subsubsection}[block]
  {\normalfont\normalsize\bfseries}
  {\thesubsubsection}{1em}{}
\titlespacing*{\subsubsection}{0pt}{1em}{0.5em}

\makeatletter
\renewcommand{\l@section}{\@dottedtocline{1}{0em}{5em}}
\renewcommand{\l@subsection}{\@dottedtocline{2}{5em}{2.5em}}
\renewcommand{\l@subsubsection}{\@dottedtocline{3}{7.5em}{3.2em}}
\renewcommand{\@dotsep}{1.5}
\makeatother

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=black,
    urlcolor=black,
    citecolor=black
}

\lstdefinestyle{pythonstyle}{
    language=Python,
    backgroundcolor=\color{gray!10},
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{blue}\bfseries,
    stringstyle=\color{red},
    commentstyle=\color{green!60!black}\itshape,
    numberstyle=\tiny\color{gray},
    numbers=left,
    numbersep=8pt,
    frame=single,
    breaklines=true,
    showstringspaces=false,
    tabsize=4,
    captionpos=b
}
\lstset{style=pythonstyle}

\pagestyle{fancy}
\fancyhf{}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0pt}
% Toleransi justifikasi (menggantikan \sloppy)
\tolerance=1000
\emergencystretch=1em
\hfuzz=2pt

\begin{document}

% ============================================================
% HALAMAN JUDUL
% ============================================================
\begin{titlepage}
    \centering
    {\LARGE\textbf{LAPORAN PROYEK AKHIR}\par}
    \vspace{0.3cm}
    {\Large\textbf{PEMROGRAMAN JARINGAN}\par}
    \vspace{0.8cm}
    {\Huge\textbf{S.C.A.R.}\par}
    \vspace{0.3cm}
    {\Large\textit{System for Countering Automated Reconnaissance}\par}
    \vspace{0.5cm}
    {\large Active Defense Honeypot dengan Multi-Layer AI\\dan Tarpit Resource Exhaustion\par}
    \vspace{0.5cm}
    \begin{figure}[H]
        \centering
        \includegraphics[width=5cm]{logo.png}
    \end{figure}
    \vspace{0.3cm}

    {\large\textbf{Disusun oleh:}\par}
    \vspace{0.5cm}
    {\large
    \begin{tabular}{ll}
        Falito Eriano Nainggolan & (2423102023) \\
        Luklu Miranda & (2423102039) \\
        Reiza Gerrard Rizki Ramadhan & (2423102070) \\
    \end{tabular}
    \par}

    \vspace{0.5cm}

    {\large\textbf{Dosen Pengampu:}\par}
    \vspace{0.3cm}
    {\large Bapak Agus Winarno, S.S.T.TP, M.T.\par}

    \vspace{0.8cm}

    {\large
    \textbf{Tingkat II Rekayasa Keamanan Siber A}\\
    \vspace{0.3cm}
    \textbf{POLITEKNIK SIBER DAN SANDI NEGARA}\\
    \vspace{0.3cm}
    \textbf{Semester Gasal 2025/2026}\\
    }
\end{titlepage}

\newpage
\tableofcontents
\newpage

% ============================================================
% BAB 1: PENDAHULUAN
% ============================================================
\newpage
\section{Pendahuluan}

\subsection{Latar Belakang}

Server HTTP merupakan komponen fundamental dalam pemrograman jaringan yang berperan sebagai titik masuk komunikasi antara klien dan layanan melalui protokol TCP/IP. Namun, setiap server yang terekspos ke jaringan publik menjadi target pemindaian otomatis oleh bot, scanner, dan script berbahaya. Berdasarkan \textit{Verizon DBIR} (2024), serangan terhadap aplikasi web meningkat 30\% secara tahunan.

Proyek \textbf{S.C.A.R. (\textit{System for Countering Automated Reconnaissance})} mengembangkan konsep \textit{honeypot} (Spitzner, 2003) dengan paradigma \textit{Active Defense}. Berbeda dari honeypot pasif, S.C.A.R. memanfaatkan \textit{chunked transfer encoding} HTTP/1.1 untuk menjebak penyerang melalui teknik \textit{Tarpit} (\textit{Resource Exhaustion}). Proyek ini mengintegrasikan aspek inti pemrograman jaringan: \textit{socket programming} (\texttt{http.server} \& \texttt{socketserver}), manipulasi protokol HTTP, integrasi REST API (AbuseIPDB, Telegram Bot), \textit{multi-threading}, dan \textit{Machine Learning} untuk analisis lalu lintas.

\subsection{Rumusan Masalah}

\begin{enumerate}[label=\arabic*.]
    \item Bagaimana membangun server HTTP menggunakan Python yang mampu menangani request masuk, menganalisis kontennya, dan memberikan respons yang sesuai secara \textit{real-time}?
    \item Bagaimana memanipulasi protokol HTTP (khususnya \textit{chunked transfer encoding} dan \textit{custom headers}) untuk mengimplementasikan mekanisme \textit{Tarpit} yang efektif menghabiskan sumber daya penyerang?
    \item Bagaimana mengintegrasikan layanan API eksternal (AbuseIPDB, Telegram Bot API) ke dalam server melalui komunikasi HTTP \textit{client-side}?
    \item Bagaimana menerapkan \textit{multi-threading} agar server tetap responsif saat menangani koneksi tarpit dan pengiriman notifikasi secara bersamaan?
\end{enumerate}

\subsection{Tujuan Proyek}

\begin{enumerate}[label=\arabic*.]
    \item Membangun server HTTP aktif berbasis Python yang berfungsi sebagai honeypot dengan kemampuan \textit{Active Defense}.
    \item Mengimplementasikan mekanisme \textit{Tarpit} yang memanfaatkan \textit{chunked transfer encoding} HTTP untuk menjebak dan menghabiskan sumber daya penyerang.
    \item Mengintegrasikan AI (\textit{Machine Learning}) sebagai komponen analisis lalu lintas jaringan untuk mendeteksi serangan secara otomatis.
    \item Mengintegrasikan API eksternal (AbuseIPDB dan Telegram Bot) melalui HTTP REST API untuk \textit{threat intelligence} dan notifikasi.
    \item Menerapkan arsitektur \textit{multi-threaded} untuk menangani operasi I/O non-blocking.
\end{enumerate}

\subsection{Batasan Proyek}

\begin{enumerate}[label=\arabic*.]
    \item Server dibangun menggunakan modul \texttt{http.server} dari pustaka standar Python.
    \item Sistem dirancang untuk berjalan pada lingkungan lokal atau server tunggal.
    \item Arsitektur \textit{threading} (\textit{thread-per-connection}) belum dioptimalkan untuk menangani ribuan koneksi simultan.
    \item Pengujian dilakukan menggunakan \textit{script} simulasi serangan dengan 5 skenario terkontrol (\textit{closed-set}).
    \item Model AI dilatih menggunakan dataset publik yang tersedia secara gratis.
\end{enumerate}

% ============================================================
% BAB 2: TINJAUAN PUSTAKA
% ============================================================
\newpage
\section{Tinjauan Pustaka}

\subsection{Protokol HTTP, Chunked Encoding, dan Socket Programming}

HTTP (\textit{Hypertext Transfer Protocol}) adalah protokol \textit{application layer} di atas TCP yang mengikuti pola \textit{request-response}: klien membuka koneksi TCP, mengirim request (metode, path, headers), dan server mengirim response (status code, headers, body). Spesifikasi HTTP/1.1 saat ini didefinisikan dalam RFC~9110 (\textit{HTTP Semantics}, Fielding et al., 2022) dan RFC~9112 (\textit{HTTP/1.1}, Fielding \& Reschke, 2022). Meskipun RFC~2616 telah digantikan oleh RFC~7230 dan RFC~9110--9112, mekanisme \textit{chunked transfer encoding} yang digunakan dalam penelitian ini tetap kompatibel secara semantik dengan spesifikasi HTTP/1.1 terbaru. Dalam S.C.A.R., pemahaman siklus ini krusial karena mekanisme tarpit bekerja dengan memanipulasi response yang \textbf{tidak pernah selesai}.

Salah satu fitur HTTP/1.1 yang dieksploitasi adalah \textit{Chunked Transfer Encoding} (RFC~9112, Section~7.1), yang memungkinkan server mengirim data secara bertahap tanpa mengetahui total ukuran konten di awal. Secara semantik protokol HTTP/1.1, koneksi dianggap tetap terbuka hingga \textit{terminating chunk} dikirimkan atau koneksi ditutup, kecuali klien menerapkan kebijakan \textit{timeout} internal --- ini adalah dasar mekanisme tarpit.

Server S.C.A.R. dibangun menggunakan modul \texttt{http.server} dan \texttt{socketserver} Python. Komponen kunci yang digunakan: \texttt{TCPServer} untuk mengelola socket (\texttt{bind()} dan \texttt{listen()}), \texttt{BaseHTTPRequestHandler} untuk mem-\textit{parse} HTTP request, dan \texttt{self.wfile} untuk menulis data langsung ke socket TCP klien --- memungkinkan pengiriman byte-per-byte tanpa buffering standar.

\subsection{Honeypot dan Tarpit}

\textit{Honeypot} (Spitzner, 2003) adalah server umpan yang menyediakan layanan palsu untuk menarik dan mempelajari penyerang. S.C.A.R. termasuk \textit{Low-Interaction Honeypot} dengan kemampuan \textit{Active Defense}. Berbeda dari honeypot pasif yang hanya mencatat, S.C.A.R. aktif menjebak penyerang melalui mekanisme \textit{tarpit}: teknik yang mempertahankan koneksi TCP tetap aktif sambil mengirim data sampah secara perlahan, sehingga sumber daya penyerang (soket, memori, \textit{thread}) ikut terikat. Konsep \textit{tarpit} pertama kali diimplementasikan oleh Tom Liston dalam proyek \textit{LaBrea} (2003).

Keunggulan \textit{tarpit}: penyerang tidak mengetahui bahwa ia sudah terdeteksi (karena menerima \texttt{HTTP 200 OK}), \textit{tool} otomatis seperti SQLMap atau Nikto akan menangguhkan pemindaian, dan kecepatan eksekusi \textit{scanning} terdegradasi.

\subsection{REST API, Threading, dan Concurrency}

S.C.A.R. bertindak sebagai \textit{server} (menerima koneksi penyerang) sekaligus \textit{client} (mengirim request ke API eksternal) secara bersamaan. Dua API digunakan: \textbf{AbuseIPDB} (HTTP GET untuk cek reputasi IP) dan \textbf{Telegram Bot API} (HTTP POST untuk notifikasi real-time).

Untuk menangani banyak koneksi bersamaan, S.C.A.R. menggunakan kelas basis \texttt{ThreadingHTTPServer} (kombinasi modular dari peladen \texttt{HTTPServer} dan modul \texttt{ThreadingMixIn}) yang akan mendelegasikan penanganan satu \textit{thread} sistem operasi untuk menangani satu koneksi secara eklusif (\textit{Thread-per-Connection}). Hal ini esensial agar pengiriman notifikasi Telegram dan \textit{tarpit stream} bersifat \textit{non-blocking} pada tataran lapisan servis.

\subsection{Machine Learning untuk Analisis Trafik Jaringan}

S.C.A.R. mengintegrasikan empat model ML (format \texttt{.pkl}, dilatih menggunakan pustaka \textit{scikit-learn}) yang secara fungsional menganalisis aspek berbeda dari setiap HTTP request. Pelatihan keempat model ini diorkestrasi menggunakan tiga dataset publik komprehensif, yaitu: (1) \textit{Malicious URLs Dataset} (Sid321axn, n.d.) untuk mendidik model URL Threat; (2) \textit{SQL Injection Dataset} (Hussain, n.d.) untuk kapabilitas deteksi SQLi; dan (3) \textit{Cookie Security \& Vulnerabilities Dataset - CSIC} (Shashikiran, n.d.) untuk memprofilkan baseline pada model HTTP Behavior dan Anomaly Detection.

Proses \textit{Feature Engineering} pada sistem ini secara arsitektural didesain dengan prioritas efisiensi saat inferensi \textit{real-time}. Untuk model klasifikasi teks (URL Threat dan SQL Injection), atribut diekstrak secara leksikal menggunakan metode \textit{Term Frequency - Inverse Document Frequency} (TF-IDF) yang beroperasi pada tingkat karakter (\textit{character-level n-grams}). Pendekatan leksikal ini terbukti sangat ringan secara komputasi sekaligus resisten terhadap teknik kebingungan teks (\textit{obfuscation}). 

Sementara itu, untuk model tebaran statistik (HTTP Behavior dan Anomaly Detection), \textit{Feature Engineering} mengekstrak tepat 7 (tujuh) atribut numerik dari setiap \textit{request} masuk. Ketujuh atribut ini kalkulasinya beroperasi dalam kompleksitas waktu konstan $O(N)$ terhadap panjang teks, meliputi:
\begin{enumerate}[topsep=0pt, itemsep=0ex, partopsep=0ex, parsep=0ex]
    \item \textbf{Kategori Metode HTTP}: Indeks kategorikal dari metode (\textit{GET}, \textit{POST}, \textit{PUT}, \textit{DELETE}, \textit{HEAD}, \textit{OPTIONS}).
    \item \textbf{Panjang URL Total}: Jumlah karakter absolut dari URI yang diminta.
    \item \textbf{Panjang URL \textit{Path}}: Jumlah karakter dari segmen lintasan (mengabaikan parameter \textit{query}).
    \item \textbf{Panjang Karakter \textit{Query String}}: Total panjang teks parameter.
    \item \textbf{Kuantitas Parameter \textit{Query}}: Jumlah pasangan kunci-nilai (\textit{key-value pairs}) yang disuntikkan.
    \item \textbf{Densitas Karakter Berbahaya}: Agregasi frekuensi kemunculan karakter khusus yang berisiko memantik injeksi (yakni: \texttt{\%}, \texttt{'}, \texttt{"}, \texttt{<}, \texttt{>}, \texttt{;}, \texttt{(}, \texttt{)}, dan \texttt{=}).
    \item \textbf{Kedalaman Direktori (\textit{Path Depth})}: Dihitung berdasarkan frekuensi karakter \textit{slash} (\texttt{/}) pada \textit{path} untuk mendeteksi anomali \textit{Directory Traversal}.
\end{enumerate}

Kalkulasi ketujuh indikator \textit{lightweight} ini menjamin biaya latensi inferensi CPU murni selalu berada di ranah \textit{sub-millisecond} per \textit{request}, mengizinkan peladen S.C.A.R. menangkap pola perilaku \textit{reconnaissance} secara tajam tanpa menahan kinerja \textit{throughput} layanan di lapisan jaringan. Tabel di bawah ini merangkum peran algoritma klasifikasinya:

\begin{table}[H]
\centering
\caption{Model AI, Akurasi Training, dan Data Jaringan yang Dianalisis}
\begin{tabularx}{\textwidth}{llcX}
\toprule
\textbf{Model} & \textbf{Algoritma} & \textbf{Akurasi} & \textbf{Data yang Dianalisis} \\
\midrule
URL Threat & Logistic Regression & 95,77\% & URL path dari request line HTTP \\
SQL Injection & Logistic Regression & 99,18\% & Query string dan body dari HTTP request \\
HTTP Behavior & Random Forest & 61,83\% & Fitur statistik: panjang URL, jumlah parameter \\
Anomaly Detection & Isolation Forest & 25,58\% & Profil keseluruhan request vs baseline normal \\
\bottomrule
\end{tabularx}
\end{table}

Pemilihan algoritma didasarkan pada karakteristik data dan peran model dalam arsitektur fusi:
\begin{itemize}
    \item \textbf{Logistic Regression (URL \& SQLi):} Dipilih karena efisien dalam memproses matriks \textit{sparse} (TF-IDF) dan secara natural memberikan probabilitas (\textit{Risk Score}). Secara komparatif, algoritma ini lebih cepat dan ringan dibandingkan Support Vector Machine (SVM) untuk klasifikasi teks berskala besar.
    \item \textbf{Random Forest (HTTP Behavior):} Merujuk pada Breiman (2001), model \textit{ensemble} ini dipilih karena ketahanannya terhadap \textit{overfitting} pada data tabular. Algoritma ini jauh lebih \textit{lightweight} (ramah CPU) dan \textit{explainable} dibandingkan pendekatan Deep Learning atau Neural Networks.
    \item \textbf{Isolation Forest (Anomaly Detection):} Merujuk pada Liu et al. (2008), algoritma \textit{unsupervised} ini sangat cocok untuk mengisolasi anomali \textit{Zero-Day}. Algoritma ini memproses data secara \textit{real-time} jauh lebih cepat dan hemat RAM dibandingkan One-Class SVM (OCSVM). Penting dicatat bahwa metrik akurasi (25,58\%) untuk model \textit{unsupervised} ini bersifat indikatif belaka yang dievaluasi berbasis \textit{pseudo-label} logikal, karena deteksi anomali pada dasarnya mengeksplorasi wilayah data yang tidak berlabel.
\end{itemize}

Dalam literatur keamanan siber, evaluasi \textit{anomaly detection} tidak selalu tepat dinilai menggunakan metrik akurasi tradisional, karena sifatnya yang \textit{unsupervised} dan bergantung pada distribusi data normal (Chandola et al., 2009). Oleh karena itu, nilai akurasi 25,58\% pada Isolation Forest dalam penelitian ini bersifat indikatif dan tidak merepresentasikan kegagalan model, melainkan keterbatasan pendekatan evaluasi berbasis \textit{pseudo-label}.

Penempatan model HTTP Behavior (akurasi 61,83\%) dan Anomaly Detection (akurasi 25,58\%) sengaja dipertahankan mengingat dalam disiplin keamanan siber, deteksi anomali tidak dapat dinilai semata-mata dari metrik akurasi murni. Kedua algoritma ini berperan khusus sebagai \textit{Soft Flag} pendukung yang menyuntikkan sinyal tambahan, bukan penentu tunggal ancaman. S.C.A.R. tidak bergantung pada satu \textit{classifier} mandiri, melainkan mengusung konsep \textit{decision-level fusion} berbasis penghitungan pembobotan risiko (\textit{risk-scoring}). Pengaturan komposisi antara sinyal kuat (\textit{Hard Flag}) dan sinyal konfirmasi silang secara kooperatif dirancang untuk meminimalkan kemunculan \textit{false positive} tanpa menutup kepekaan sistem membaca pola lalu lintas jaringan yang menyimpang.

\subsection{Agregasi Risk Score}
Setiap parameter masukan akan dievaluasi oleh hierarki kombinasi model pintar. \textit{Risk Score} individual berasal dari nilai probabilitas model deterministik. Secara baku, sistem melakukan agregasi rata-rata (\textit{Mean Aggregation}) dari seluruh model aktif. Ambang batas pemblokiran (\textit{Risk Threshold}) untuk menginisialisasi \textit{tarpit} ditetapkan pada skor agregat $\geq 0.7$. Pemilihan nilai 0,7 ini didasarkan pada prinsip optimasi kurva \textit{Receiver Operating Characteristic} (ROC) (Fawcett, 2006), yang bertujuan memprioritaskan presisi dan menekan \textit{False Positive Rate} (FPR). Karena penalti dari menjebak pengguna sah dengan \textit{tarpit} sangat merugikan ketersediaan layanan, ambang batas konservatif digunakan agar sistem hanya bereaksi pada probabilitas ancaman yang sangat meyakinkan. Namun, pemastian arsitektural menetapkan bahwa apabila suatu \textit{request} memantik \textit{Hard Flag} (contoh: deteksi mutlak SQLi), mekanisme \textit{tarpit} akan dipicu seketika tanpa menghiraukan skor agregat rata-rata. Kebijakan defensif absolut ini krusial untuk mencegah kelolosan injeksi murni yang sengaja dikaburkan oleh \textit{payload} normal.

\input{bab3_implementasi}

\end{document}
